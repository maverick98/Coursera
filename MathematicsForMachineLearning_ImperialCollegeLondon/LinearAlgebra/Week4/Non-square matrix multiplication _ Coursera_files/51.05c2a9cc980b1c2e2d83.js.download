(window.webpackJsonp=window.webpackJsonp||[]).push([[51,49],{"+871":function(module,e,t){"use strict";t.r(e),t.d(e,"PracticeQuizAttemptPage",function(){return E}),t.d(e,"withRedirectToCover",function(){return j});var n=t("VbXa"),s=t.n(n),r=t("sbe7"),i=t.n(r),a=t("EqTq"),o=t("m10x"),u=t("+LJP"),c=t("sQ/U"),d=t("JEIr"),m=t("oe9u"),l=t("/oRK"),p=t("XFHP"),f=t("22Sa"),I=t("eK4/"),g=t("Gpyo"),b=t("xmEj"),v=t("RH4a"),y=t("zaiP"),S=t("wuov"),D=t("4QSv"),h=t("VtNW"),R=t.n(h),Q=t("3AUy"),P=t.n(Q),z=Object(a.a)("PracticeQuizAttemptPage"),E=function(e){function PracticeQuizAttemptPage(){return e.apply(this,arguments)||this}s()(PracticeQuizAttemptPage,e);var t=PracticeQuizAttemptPage.prototype;return t.componentDidMount=function componentDidMount(){var e=this.props,t=e.shouldRedirectToCover,n=e.redirectToCover;t&&n()},t.render=function render(){var e=this.props,t=e.redirectToCover,n=e.addRedirectToCoverToRouteParams,s=e.examSessionId;return i.a.createElement(y.a,null,function(e){var r=e.item;if(!r)return null;return i.a.createElement(f.a,{onClose:t,headerLeft:i.a.createElement(m.a,{headerText:r.name,itemTypeText:R()("Practice Quiz"),timeCommitment:r.timeCommitment}),headerRight:i.a.createElement(l.a,{deadline:r.deadline}),topBanner:i.a.createElement(d.a,{slug:r.courseSlug,itemId:r.id,userId:c.a.get().id},function(e){var n=e.bestEvaluation;return i.a.createElement(g.b,{slug:r.courseSlug,itemId:r.id,userId:c.a.get().id,fetchPolicy:"network-only",examSessionId:s},function(e){var s=e.isSubmitted,a,o=(r.contentSummary&&"quiz"===r.contentSummary.typeName&&r.contentSummary.definition||{}).passingFraction,u=n||{},c=u.score,d=void 0===c?0:c,m=u.maxScore,l=void 0===m?0:m,p=n?l&&d/l:void 0,f=p?p>=o:void 0;if(s&&o&&"number"==typeof p)return i.a.createElement(D.a,{passingFraction:o,itemGrade:{grade:p,isPassed:f||!1,isOverridden:!1,latePenaltyRatio:null},onKeepLearningClick:t,onTryAgainClick:t});return null})})},i.a.createElement(g.b,{slug:r.courseSlug,itemId:r.id,userId:c.a.get().id,fetchPolicy:"network-only",examSessionId:s},function(e){var t=e.loading,s=e.practiceQuizFormData,a=e.sessionId,u=e.nextSubmissionDraftId,c=e.totalPoints,d=e.isSubmitted,m=e.hasDraft;if(t||!s)return i.a.createElement(S.a,null);var l=s.map(function(e){return e.prompt.id});return i.a.createElement(v.a,{itemId:r.id,courseId:r.courseId},function(e){var t=e.stepState,f=e.setStepState;return i.a.createElement("div",{className:z()},i.a.createElement("div",{className:z("header")},i.a.createElement(o.d,null,r.name),i.a.createElement(o.a,{rootClassName:z("points")},i.a.createElement(o.h,{tag:"span"},R()("Total points #{totalPoints}",{totalPoints:c})))),i.a.createElement("div",{className:z("prompts")},s.map(function(e,n){return i.a.createElement(I.a,{key:e.prompt.id,quizQuestion:e,index:n,isReadOnly:!!d,isDisabled:!!(t||{}).isSaving||!!(t||{}).isSubmitting})})),!d&&i.a.createElement(b.a,{ids:l,sessionId:a,nextSubmissionDraftId:u},function(e){var s=e.saveDraft,a=e.autoSaveDraft,o=e.submitDraft;return i.a.createElement(p.a,{itemId:r.id,courseId:r.courseId,saveDraft:s,autoSaveDraft:a,submitDraft:function submitDraft(){return o?o().then(function(){n()}):Promise.reject()},hasDraft:m,stepState:t,setStepState:f})}))})}))})},PracticeQuizAttemptPage}(i.a.Component),j=Object(u.a)(function(e,t){var n=t.refetchPracticeQuizCoverPageData;return{redirectToCover:function redirectToCover(){n&&n(),e.push({name:"practice-quiz-cover",params:e.params,query:e.location.query}),window.location.reload()},addRedirectToCoverToRouteParams:function addRedirectToCoverToRouteParams(){e.push({name:"practice-quiz-attempt",params:e.params,query:{redirectToCover:!0}})},shouldRedirectToCover:e.location.query.redirectToCover}});e.default=j(E)},Gpyo:function(module,e,t){"use strict";t.d(e,"a",function(){return p}),t.d(e,"c",function(){return g});var n=t("MVZn"),s=t.n(n),r=t("VkAN"),i=t.n(r),a=t("sbe7"),o=t.n(a),u=t("lTCR"),c=t.n(u),d=t("oJmH"),m=t.n(d),l=t("TUhR");function _templateObject2(){var e=i()(['\n  query practiceQuizDataQuery(\n    $itemId: String!\n    $userId: Int!\n    $slug: String!\n    $sessionId: String!\n    $body: String!\n    $skipFetchingResponses: Boolean!\n  ) {\n    practiceQuizQuestionData(itemId: $itemId, userId: $userId, slug: $slug, sessionId: $sessionId, body: $body)\n      @rest(\n        type: "RestPracticeQuizQuestionGetStateData"\n        path: "opencourse.v1/user/{args.userId}/course/{args.slug}/item/{args.itemId}/quiz/session/{args.sessionId}/action/getState?autoEnroll=false"\n        method: "POST"\n        bodyKey: "body"\n      ) {\n      contentResponseBody @type(name: "RestPracticeQuizQuestionDataResponseBody") {\n        return @type(name: "RestContentResponseBodyReturnObject") {\n          questions\n          nextSubmissionDraftId\n        }\n      }\n    }\n    practiceQuizQuestionResponses(itemId: $itemId, userId: $userId, slug: $slug, sessionId: $sessionId, body: $body)\n      @skip(if: $skipFetchingResponses)\n      @rest(\n        type: "RestPracticeQuizLatestSubmissionDraftResponse"\n        path: "opencourse.v1/user/{args.userId}/course/{args.slug}/item/{args.itemId}/quiz/session/{args.sessionId}/action/getLatestSubmissionDraft?autoEnroll=false"\n        method: "POST"\n        bodyKey: "body"\n      ) {\n      contentResponseBody @type(name: "RestPracticeQuizQuestionDataResponseBody") {\n        return @type(name: "RestContentResponseBodyReturnObject") {\n          draft\n        }\n      }\n    }\n  }\n']);return _templateObject2=function _templateObject2(){return e},e}function _templateObject(){var e=i()(['\n  query practiceQuizSessionMetaDataQuery($itemId: String!, $userId: Int!, $slug: String!, $body: String!) {\n    practiceQuizSessionMetaData(body: $body, itemId: $itemId, userId: $userId, slug: $slug)\n      @rest(\n        type: "RestPracticeQuizSessionMetadata"\n        path: "opencourse.v1/user/{args.userId}/course/{args.slug}/item/{args.itemId}/quiz/session"\n        method: "POST"\n        bodyKey: "body"\n      ) {\n      contentResponseBody @type(name: "RestPracticeQuizSessionDataResponseBody")\n    }\n  }\n']);return _templateObject=function _templateObject(){return e},e}var p={contentRequestBody:{argument:[]}},f={contentRequestBody:[]},I=c()(_templateObject()),g=c()(_templateObject2()),b=function PracticeQuizData(e){var t=e.slug,n=e.itemId,r=e.userId,i=e.fetchPolicy,a=void 0===i?"cache-first":i,u=e.examSessionId,c=e.children,m={slug:t,itemId:n,userId:r};return o.a.createElement(d.Query,{query:I,variables:s()({},m,{body:f}),fetchPolicy:a,skip:!!u},function(e){var t=e.loading,n=e.data,r=e.refetch;if(t&&!u)return c({loading:t});var i=u||((((n||{}).practiceQuizSessionMetaData||{}).contentResponseBody||{}).session||{}).id;return o.a.createElement(d.Query,{query:g,variables:s()({},m,{sessionId:i,body:p,skipFetchingResponses:!!u}),fetchPolicy:a},function(e){var t=e.loading,n=e.data,s=e.refetch,a=e.client;if(t)return c({loading:t});var o=(((n||{}).practiceQuizQuestionData||{}).contentResponseBody||{}).return,d=o.questions,m=o.nextSubmissionDraftId,p,f,I,g=((((((n||{}).practiceQuizQuestionResponses||{}).contentResponseBody||{}).return||{}).draft||{}).input||{}).responses,b=Object(l.a)(d,g,!!u),v=b.reduce(function(e,t){return e+t.prompt.weightedScoring.maxScore},0),y=!d[0].isSubmitAllowed,S,D;return c({loading:t,practiceQuizFormData:b,sessionId:i,totalPoints:v,isSubmitted:y,nextSubmissionDraftId:m,hasDraft:!!g,refetchPracticeQuizData:function refetchPracticeQuizData(){return r().then(function(){return s()})},client:a})})})};e.b=b},"a7+h":function(module,e,t){"use strict";t.d(e,"a",function(){return I});var n=t("VkAN"),s=t.n(n),r=t("sbe7"),i=t.n(r),a=t("lTCR"),o=t.n(a),u=t("oJmH"),c=t.n(u),d=t("kqcj");function _templateObject2(){var e=s()(['\n  mutation practiceQuizSubmitResponseActionMutation(\n    $itemId: String!\n    $userId: Int!\n    $slug: String!\n    $sessionId: String!\n    $body: String!\n  ) {\n    action(itemId: $itemId, userId: $userId, slug: $slug, sessionId: $sessionId, body: $body)\n      @rest(\n        type: "PracticeQuizSubmitResponseData"\n        path: "opencourse.v1/user/{args.userId}/course/{args.slug}/item/{args.itemId}/quiz/session/{args.sessionId}/action/submitResponses?autoEnroll=false"\n        method: "POST"\n        bodyKey: "body"\n      ) {\n      contentResponseBody @type(name: "RestPracticeQuizQuestionDataResponseBody") {\n        return @type(name: "RestContentResponseBodyReturnObject") {\n          nextSubmissionDraftId\n          evaluation\n          questions\n        }\n      }\n    }\n  }\n']);return _templateObject2=function _templateObject2(){return e},e}function _templateObject(){var e=s()(['\n  mutation practiceQuizSaveSubmissionDraftActionMutation(\n    $itemId: String!\n    $userId: Int!\n    $slug: String!\n    $sessionId: String!\n    $body: String!\n  ) {\n    action(itemId: $itemId, userId: $userId, slug: $slug, sessionId: $sessionId, body: $body)\n      @rest(\n        type: "PracticeQuizSaveSubmissionDraftData"\n        path: "opencourse.v1/user/{args.userId}/course/{args.slug}/item/{args.itemId}/quiz/session/{args.sessionId}/action/saveSubmissionDraft?autoEnroll=false"\n        method: "POST"\n        bodyKey: "body"\n      ) {\n      contentResponseBody @type(name: "RestPracticeQuizQuestionDataResponseBody") {\n        return @type(name: "RestContentResponseBodyReturnObject") {\n          nextSubmissionDraftId\n          questions @skip(if: $skipQuestionsField)\n          evaluation\n        }\n      }\n    }\n  }\n']);return _templateObject=function _templateObject(){return e},e}var m=o()(_templateObject()),l=o()(_templateObject2()),p=function SaveDraftMutation(e){var t=e||{},n=t.changedResponses,s=t.nextSubmissionDraftId,r=t.sessionId,a=t.userId,o=t.itemId,c=t.slug;return i.a.createElement(u.Mutation,{mutation:m,update:Object(d.a)(e)},function(t){var i={contentRequestBody:{argument:{id:s,input:{responses:n}}}},u=function saveDraft(){return t({variables:{body:i,sessionId:r,userId:a,itemId:o,slug:c,skipQuestionsField:!0}})},d=function autoSaveDraft(){return t({variables:{body:i,sessionId:r,userId:a,itemId:o,slug:c,skipQuestionsField:!0}})};return e.children({saveDraft:u,autoSaveDraft:d})})},f=function SubmitDraftMutation(e){var t=e||{},n=t.changedResponses,s=t.sessionId,r=t.userId,a=t.itemId,o=t.slug;return i.a.createElement(u.Mutation,{mutation:l,update:Object(d.a)(e)},function(t){var i={contentRequestBody:{argument:{responses:n}}},u=function submitDraft(){return t({variables:{body:i,sessionId:s,userId:r,itemId:a,slug:o}})};return e.children({submitDraft:u})})},I=function PracticeQuizMutations(e){var t=e.ids,n=e.sessionId,s=e.itemId,r=e.courseId,a=e.changedResponses,o=e.children,u=e.slug,c=e.userId,d=e.nextSubmissionDraftId;return i.a.createElement(p,{changedResponses:a,nextSubmissionDraftId:d,sessionId:n,userId:c,itemId:s,slug:u},function(e){var t=e.saveDraft,r=e.autoSaveDraft;return i.a.createElement(f,{changedResponses:a,sessionId:n,userId:c,itemId:s,slug:u},function(e){var n=e.submitDraft;return o({saveDraft:t,autoSaveDraft:r,submitDraft:n})})})},g=I},glp6:function(module,e,t){"use strict";t.r(e);var n=t("sbe7"),s=t.n(n),r=t("zaiP"),i=t("JEIr"),a=t("sQ/U"),o=t("+871"),u=function SubmittedPracticeQuizAttemptPage(){return s.a.createElement(r.a,null,function(e){var t=e.item;if(!t||!t.contentSummary)return null;return s.a.createElement(i.a,{slug:t.courseSlug,itemId:t.id,userId:a.a.get().id},function(e){var n=e.loading,r=e.lastSessionId;if(!t||!t.contentSummary||n)return null;return s.a.createElement(o.default,{examSessionId:r})})})};e.default=u},kqcj:function(module,e,t){"use strict";var n=t("Gpyo"),s=function practiceQuizActionMutationUpdate(e){return function(t,s){var r=s.data,i=e.itemId,a=e.userId,o=e.slug,u=e.sessionId,c=(((r||{}).action||{}).contentResponseBody||{}).return||null,d=t.readQuery({query:n.c,variables:{itemId:i,userId:a,slug:o,sessionId:u,skipFetchingResponses:!1,body:n.a}}),m=(((d||{}).practiceQuizQuestionData||{}).contentResponseBody||{}).return||null;m&&(m.nextSubmissionDraftId=(c||{}).nextSubmissionDraftId||null,m.questions=(c||{}).questions||m.questions||null,m.evaluation=(c||{}).evaluation||null,t.writeQuery({query:n.c,variables:{itemId:i,userId:a,slug:o,sessionId:u,skipFetchingResponses:!1,body:n.a},data:d}))}};e.a=s},xmEj:function(module,e,t){"use strict";var n=t("sbe7"),s=t.n(n),r=t("agp5"),i=t("RH4a"),a=t("0n3a"),o=t("zaiP"),u=t("JEIr"),c=t("sQ/U"),d=t("wjH1"),m=t("a7+h"),l=function PracticeQuizActions(e){var t=e.ids,n=e.sessionId,l=e.children,p=e.nextSubmissionDraftId;return s.a.createElement(o.a,null,function(e){var o=e.item;if(!o)return null;var f=o.courseId,I=o.id,g=o.courseSlug;return s.a.createElement(u.a,{userId:c.a.get().id,itemId:I,slug:g},function(e){var u=e.refetch;return s.a.createElement(r.a,{ids:t},function(e){if(!e||!u)return l({});return s.a.createElement(i.a,{itemId:I,courseId:f},function(r){var i=r.stepState,b=r.setStepState,v=e.map(function(e){return{questionInstance:e.id,response:((e.response||{}).definition||{}).value}});return s.a.createElement(m.a,{ids:t,sessionId:n,itemId:I,courseId:f,slug:g,userId:c.a.get().id,changedResponses:v,nextSubmissionDraftId:p},function(t){var n=t.saveDraft,r=t.submitDraft,c=function saveDraft(){if(!i.isSaving&&!i.isSubmitting&&p)return b({isSaving:!0}),n().then(function(){return b({isSaving:!1})}).catch(function(e){return Object(d.a)(e,b)});return Promise.reject()},m=function autoSaveDraft(){if(!i.isAutoSaving&&!i.isSubmitting&&p)return b({isAutoSaving:!0}),n().then(function(){return b({isAutoSaving:!1})}).catch(function(e){return Object(d.a)(e,b)});return Promise.reject()},f=function refetchItemAndEvaluations(){return u().then(function(){return o.refetch()}).catch(function(e){return Object(d.a)(e,b)})},I=function submitDraft(){if(!i.isSubmitting)return b({isSubmitting:!0}),r().then(function(){return b({isSubmitting:!1})}).then(f).catch(function(e){return Object(d.a)(e,b)});return Promise.reject()};return s.a.createElement(a.a,{stepState:i,saveDraft:m,changedResponses:e},function(){return l({saveDraft:c,autoSaveDraft:m,submitDraft:I})})})})})})})};e.a=l}}]);
//# sourceMappingURL=51.05c2a9cc980b1c2e2d83.js.map